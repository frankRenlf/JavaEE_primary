<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/blog_login.css">

</head>

<body>
    <div class="nav">

        <img src="../images/male.png" alt="male">
        <span class="title">My blog</span>
        <span class="spacer"></span>

        <!-- <a href="./blog_list.html">Home page</a>
        <a href="./blog_edit.html">edit blog</a>
        <a href="#">Log out</a> -->
    </div>

    <div class="login-container">
        <!-- 中间的登陆框 -->
        <div class="login-dialog">
            <h3>登陆</h3>
            <div class="row">
                <span>ID</span>
                <input type="text" class="userid">
            </div>
            <div class="row">
                <span>用户名</span>
                <input type="text" class="username">
            </div>
            <div class="row">
                <span>密码</span>
                <input type="password" class="password">
            </div>
            <div class="row">
                <button class="submit">提交</button>
            </div>
        </div>

    </div>
</body>
<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script>
    let id = document.querySelector('.userid');
    let un = document.querySelector('.username');
    let pw = document.querySelector('.password');
    let btn = document.querySelector('.submit');
    function staticMsg() {
        console.log(un.value + ': ' + pw.value);
        if (un.value == 'frank' && pw.value == 'rlf') {
            window.location.href = './blog_list.html';
        } else {
            if (un.value != 'frank') {
                alert('wrong username')
            } else if (pw.value != 'rlf') {
                alert('Wrong password');
            } else {
                alert('invalid input');
            }
        }
    }
    // btn.onclick = function () {
    //     let uid = id.value;
    //     let uname = un.value;
    //     let upassword = pw.value;
    //     let user = {
    //         "id": uid,
    //         "username": uname,
    //         "password": upassword
    //     }
    //     ajax('POST', 'http://localhost/user', user)
    // };
    function ajax(method, url, maindata) {
        let uid = id.value;
        let uname = un.value;
        let upassword = pw.value;
        var xhr = new XMLHttpRequest();
        xhr.open(method, url);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify(maindata));
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var msg = JSON.parse(xhr.responseText);
                if (msg.data == true) {
                    window.location.href = './blog_list.html';
                }
            }
        }
    }
    $('.submit').on('click', function () {
        let uid = id.value;
        let uname = un.value;
        let upassword = pw.value;
        let user = {
            "id": uid,
            "username": uname,
            "password": upassword
        }
        $.ajax({
            type: "POST",
            contentType: 'application/json',
            data: JSON.stringify(user),
            url: 'http://localhost/user',
            success: function (body) {
                let con = document.querySelector('.text1');
                console.log(typeof (body.data));
                console.log(body);
                if (body.data) {
                    window.location.href = './blog_list.html';
                }
                // con.value = body.data.id;
            }
        });
    });
    // document.onkeydown = jump();

    // btn.addEventListener("keyup", function (event) {
    //     event.preventDefault()
    //     if (event.keyCode === 13) {
    //         jump();
    //     }
    // })

</script>

</html>